Сделано:
1. Cython-директивы boundscheck=False, wraparound=False, cdivision=True. Это убирает проверки границ массивов и лишние операции Python.
2. Статическая типизация циклов и флагов: cdef Py_ssize_t i в циклах, bint _dirty. Ускоряет перебор массивов и проверку состояния.
3. Итеративная топологическая сортировка через to_c_struct() вместо рекурсивного обхода DAG. Меньше вызовов Python-функций, нет рекурсии.
4. Использование NumPy массивов. Входные данные и арифметика через np.float64. Арифметика выполняется на C-уровне.
5. Минимизация временных объектов. В SumDouble и Product новые массивы создаются только при необходимости.
6. Кэширование порядка DAG через _order и _dirty. Мы сохраняем порядок обхода, чтобы не пересчитывать его каждый раз. Если граф не меняется, просто используем готовый порядок.

В планах:
1. Заменить списки Python на массивы C. inputs и outputs хранить как Node[:] или массив указателей C.
2. Сделать _last как memoryview или C-массив вместо Python-объекта NumPy. Это снизит оверхед при каждом вызове run.
3. Сложение и умножение полностью на C уровне через memoryview и cdef циклы вместо Python-операций.
4. Убрать Python-объекты в Sum, Product и Sin. Арифметика полностью на C уровне. 
5. Компактное хранение DAG. Все узлы как один contiguous массив структур Node в C.
6. Векторизация через SIMD инструкции через Cython или NumPy C-API для массивов.
